<template>
  <div class="col-xl-3 col-12 col-sm-6 col-lg-6 col-md-6 mb-4">
    <div
      :class="`
        card
        bg-white
        card-shadowed
        rounded
        overflow-hidden
        font-family_brown
        line-height-100p
        pointer
      `"
      @click="handleCardClick(exercise)"
    >
      <!-- :src="exercise.image_url" -->
      <div
        class="
          align-items-center
          d-flex
          justify-content-center
          position-relative
        "
        :style="`background-color: ${color}; height: 128px`"
      >
        <!-- page !== 'dashboard'
            ? exercise.subject_details.icon_data.icon_bg_color
            : exercise.subject.icon_data.icon_bg_color -->

        <!-- page !== 'dashboard'
              ? exercise.subject_details.icon_data.icon_base_64
              : exercise.subject.icon_data.icon_base_64
           -->
        <img :src="image" class="object-fit-contain" height="70px" />
        <!-- <img src="" class="w-100 object-fit-cover" height="128" /> -->
        <div
          class="
            position-absolute
            bottom-0
            right-0
            fs-12
            px-lg-2
            py-1
            bg-white
            text-dark
            opacity-90p
          "
        >
          {{ exercise.subject.name ? exercise.subject.name : exercise.subject }}
        </div>
      </div>
      <div class="px-3 py-3">
        <div class="text-truncate fs-14 text-dark font-weight-bold mb-3">
          {{ exercise.name }}
        </div>
        <div class="d-flex align-items-end justify-content-between">
          <div class="fs-12 text-dark">
            <div class="mb-2 text-capitalize">{{ exercise.type }}</div>
            <div class="mb-1">
              <span class="text-light">Date Due:</span>
              <span class="text-dark">{{
                new Date(exercise.due_date).toLocaleDateString()
              }}</span>
            </div>
            <div class="">
              <span
                :class="`text-capitalize ${
                  exercise.student_status === 'new' ||
                  exercise.student_status === 'expired'
                    ? 'dangerText'
                    : exercise.student_status === 'submitted'
                    ? 'warnText'
                    : 'successText'
                }`"
                >{{
                  exercise.student_status === 'new'
                    ? 'Not started'
                    : exercise.student_status === 'expired'
                    ? 'Overdue'
                    : exercise.student_status
                }}
              </span>
            </div>
          </div>
          <div>
            <svg
              v-if="exercise.qc_mode === 'classwork'"
              width="28"
              height="28"
              viewBox="0 0 31 31"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <rect
                opacity="0.5"
                width="31"
                height="31"
                rx="15.5"
                fill="#E7E8EB"
              ></rect>
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M6.23521 6.75H5.74219V20.4115H18.5608V19.3996H6.72823V7.76197H21.0259V9.7859H22.012V6.75H6.23521ZM21.5189 13.3278C21.7132 13.3278 21.9055 13.2885 22.085 13.2122C22.2644 13.136 22.4275 13.0241 22.5648 12.8832C22.7022 12.7422 22.8111 12.5749 22.8854 12.3907C22.9598 12.2066 22.998 12.0092 22.998 11.8098C22.998 11.6105 22.9598 11.4131 22.8854 11.2289C22.8111 11.0448 22.7022 10.8774 22.5648 10.7365C22.4275 10.5955 22.2644 10.4837 22.085 10.4074C21.9055 10.3311 21.7132 10.2919 21.5189 10.2919C21.1267 10.2919 20.7505 10.4518 20.4731 10.7365C20.1957 11.0212 20.0399 11.4072 20.0399 11.8098C20.0399 12.2124 20.1957 12.5985 20.4731 12.8832C20.7505 13.1679 21.1267 13.3278 21.5189 13.3278ZM20.49 14.3443C20.4723 14.3443 20.454 14.3443 20.4363 14.3453H19.5469C19.436 14.3453 19.3265 14.371 19.2266 14.4203C19.1266 14.4696 19.0388 14.5413 18.9695 14.6302L17.2193 16.8752H14.6166C14.4205 16.8752 14.2324 16.9552 14.0937 17.0975C13.955 17.2399 13.8771 17.4329 13.8771 17.6342C13.8771 17.8355 13.955 18.0285 14.0937 18.1709C14.2324 18.3132 14.4205 18.3932 14.6166 18.3932H17.5748C17.6856 18.3932 17.7951 18.3675 17.895 18.3182C17.995 18.2689 18.0828 18.1972 18.1521 18.1083L19.0947 16.899V25.9232C19.0955 26.1423 19.1807 26.3522 19.3317 26.5071C19.4828 26.662 19.6873 26.7493 19.9008 26.75C20.1143 26.7492 20.3187 26.6618 20.4696 26.507C20.6205 26.3521 20.7057 26.1423 20.7064 25.9232V21.7878H22.3186V25.9232C22.3194 26.1423 22.4045 26.3521 22.5554 26.507C22.7064 26.6618 22.9108 26.7492 23.1242 26.75C23.3377 26.7493 23.5423 26.662 23.6933 26.5071C23.8444 26.3522 23.9295 26.1423 23.9303 25.9232V19.776C24.3736 19.776 25.7422 18.9103 25.7422 16.7781C25.7422 15.1711 24.3736 14.3443 23.9303 14.3443H20.49Z"
                fill="#1070B7"
              ></path>
            </svg>
            <svg
              v-if="exercise.qc_mode === 'examination'"
              width="28"
              height="28"
              viewBox="0 0 31 31"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <rect
                opacity="0.5"
                width="31"
                height="31"
                rx="15.5"
                fill="#E7E8EB"
              ></rect>
              <path
                d="M16.9791 7.64206C16.9233 7.57819 16.8493 7.53287 16.767 7.51217C16.6848 7.49147 16.5981 7.49637 16.5187 7.52622C16.4393 7.55607 16.3709 7.60945 16.3227 7.67921C16.2744 7.74898 16.2486 7.83182 16.2487 7.91665V10.8333C16.2487 11.0543 16.3365 11.2663 16.4928 11.4226C16.6491 11.5788 16.861 11.6666 17.082 11.6666H19.582C19.6621 11.6667 19.7406 11.6437 19.8079 11.6003C19.8753 11.557 19.9287 11.4951 19.9618 11.4222C19.9949 11.3493 20.0063 11.2683 19.9946 11.1891C19.9829 11.1098 19.9486 11.0356 19.8958 10.9754L16.9791 7.64206ZM13.6445 14.5833H13.0195L13.332 13.8333L13.6445 14.5833ZM16.4812 7.08331L20.4154 11.4112V21.6666C20.4154 21.9982 20.2837 22.3161 20.0492 22.5505C19.8148 22.7849 19.4969 22.9166 19.1654 22.9166H10.832C10.5005 22.9166 10.1826 22.7849 9.94815 22.5505C9.71373 22.3161 9.58203 21.9982 9.58203 21.6666V8.33331C9.58203 8.00179 9.71373 7.68385 9.94815 7.44943C10.1826 7.21501 10.5005 7.08331 10.832 7.08331H16.4812ZM14.1012 11.3458C14.0379 11.194 13.9311 11.0643 13.7942 10.9731C13.6573 10.8818 13.4965 10.8331 13.332 10.8331C13.1675 10.8331 13.0067 10.8818 12.8698 10.9731C12.733 11.0643 12.6262 11.194 12.5629 11.3458L10.4795 16.3458C10.3944 16.5498 10.3939 16.7793 10.478 16.9837C10.562 17.1881 10.7239 17.3507 10.9279 17.4358C11.1319 17.5209 11.3613 17.5215 11.5657 17.4374C11.7701 17.3533 11.9328 17.1915 12.0179 16.9875L12.3249 16.25H14.3391L14.6462 16.9875C14.7313 17.1915 14.8939 17.3533 15.0983 17.4374C15.3028 17.5215 15.5322 17.5209 15.7362 17.4358C15.9402 17.3507 16.102 17.1881 16.1861 16.9837C16.2702 16.7793 16.2696 16.5498 16.1845 16.3458L16.1416 16.2433C16.1766 16.2475 16.2124 16.25 16.2487 16.25H16.6654V16.6666C16.6654 16.8877 16.7532 17.0996 16.9094 17.2559C17.0657 17.4122 17.2777 17.5 17.4987 17.5C17.7197 17.5 17.9317 17.4122 18.088 17.2559C18.2442 17.0996 18.332 16.8877 18.332 16.6666V16.25H18.7487C18.9697 16.25 19.1817 16.1622 19.338 16.0059C19.4942 15.8496 19.582 15.6377 19.582 15.4166C19.582 15.1956 19.4942 14.9837 19.338 14.8274C19.1817 14.6711 18.9697 14.5833 18.7487 14.5833H18.332V14.1666C18.332 13.9456 18.2442 13.7337 18.088 13.5774C17.9317 13.4211 17.7197 13.3333 17.4987 13.3333C17.2777 13.3333 17.0657 13.4211 16.9094 13.5774C16.7532 13.7337 16.6654 13.9456 16.6654 14.1666V14.5833H16.2487C15.9787 14.5833 15.7387 14.7116 15.5862 14.9108L14.1012 11.3462V11.3458ZM11.2487 17.9166C11.0277 17.9166 10.8157 18.0044 10.6594 18.1607C10.5032 18.317 10.4154 18.529 10.4154 18.75C10.4154 18.971 10.5032 19.183 10.6594 19.3392C10.8157 19.4955 11.0277 19.5833 11.2487 19.5833C11.0277 19.5833 10.8157 19.6711 10.6594 19.8274C10.5032 19.9837 10.4154 20.1956 10.4154 20.4166C10.4154 20.6377 10.5032 20.8496 10.6594 21.0059C10.8157 21.1622 11.0277 21.25 11.2487 21.25H16.2487C16.4697 21.2501 16.6817 21.1624 16.8381 21.0062C16.9944 20.85 17.0823 20.6381 17.0824 20.4171C17.0826 20.196 16.9949 19.984 16.8387 19.8277C16.6825 19.6713 16.4705 19.5834 16.2495 19.5833H18.7487C18.9697 19.5833 19.1817 19.4955 19.338 19.3392C19.4942 19.183 19.582 18.971 19.582 18.75C19.582 18.529 19.4942 18.317 19.338 18.1607C19.1817 18.0044 18.9697 17.9166 18.7487 17.9166H11.2487Z"
                fill="#1070B7"
                stroke="#1070B7"
                stroke-linejoin="round"
              ></path>
            </svg>
            <svg
              v-if="exercise.qc_mode === 'homework'"
              width="28"
              height="28"
              viewBox="0 0 31 31"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <rect
                opacity="0.5"
                width="31"
                height="31"
                rx="15.5"
                fill="#E7E8EB"
              ></rect>
              <path
                d="M15.2174 8.95577C15.1593 8.90014 15.0819 8.86909 15.0014 8.86909C14.9209 8.86909 14.8436 8.90014 14.7854 8.95577L7.59399 15.8257C7.56345 15.8549 7.53916 15.89 7.52257 15.9289C7.50599 15.9678 7.49746 16.0096 7.49751 16.0519L7.49634 22.4995C7.49634 22.831 7.62803 23.149 7.86245 23.3834C8.09687 23.6178 8.41482 23.7495 8.74634 23.7495H12.5002C12.666 23.7495 12.825 23.6837 12.9422 23.5665C13.0594 23.4493 13.1252 23.2903 13.1252 23.1245V17.812C13.1252 17.7291 13.1582 17.6497 13.2168 17.591C13.2754 17.5324 13.3549 17.4995 13.4377 17.4995H16.5627C16.6456 17.4995 16.7251 17.5324 16.7837 17.591C16.8423 17.6497 16.8752 17.7291 16.8752 17.812V23.1245C16.8752 23.2903 16.9411 23.4493 17.0583 23.5665C17.1755 23.6837 17.3345 23.7495 17.5002 23.7495H21.2526C21.5841 23.7495 21.9021 23.6178 22.1365 23.3834C22.3709 23.149 22.5026 22.831 22.5026 22.4995V16.0519C22.5026 16.0096 22.4941 15.9678 22.4775 15.9289C22.4609 15.89 22.4366 15.8549 22.4061 15.8257L15.2174 8.95577Z"
                fill="#1070B7"
              ></path>
              <path
                d="M24.1757 14.5371L21.2538 11.7418V7.5C21.2538 7.33424 21.188 7.17527 21.0708 7.05806C20.9536 6.94085 20.7946 6.875 20.6288 6.875H18.7538C18.5881 6.875 18.4291 6.94085 18.3119 7.05806C18.1947 7.17527 18.1288 7.33424 18.1288 7.5V8.75L15.8663 6.58672C15.6546 6.37266 15.3398 6.25 14.9995 6.25C14.6605 6.25 14.3464 6.37266 14.1347 6.58711L5.82609 14.5363C5.58312 14.7707 5.55265 15.1563 5.77375 15.4102C5.82927 15.4742 5.89725 15.5264 5.97355 15.5634C6.04985 15.6003 6.13288 15.6214 6.21759 15.6253C6.30229 15.6292 6.3869 15.6157 6.46626 15.5859C6.54562 15.556 6.61808 15.5103 6.67921 15.4516L14.7847 7.70625C14.8428 7.65062 14.9202 7.61957 15.0007 7.61957C15.0812 7.61957 15.1586 7.65062 15.2167 7.70625L23.323 15.4516C23.4424 15.5661 23.6023 15.6286 23.7677 15.6253C23.9331 15.6221 24.0905 15.5535 24.2054 15.4344C24.4452 15.1859 24.4253 14.7758 24.1757 14.5371Z"
                fill="#1070B7"
              ></path>
            </svg>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
export default {
  props: {
    exercise: {
      type: Object,
      required: true,
    },
    color: {
      type: String,
      required: true,
    },
    image: {
      type: String,
      required: true,
    },
  },
  methods: {
    checkIfToShow(item) {
      // debugger
      if (this.page === 'dashboard' && item.subject) {
        return true
      }
      if (this.page === 'others' && item.subject_details) {
        return true
      }
      return false
    },
    slugify(text) {
      const hmmm = text || 'loading'
      return hmmm
        .toString()
        .toLowerCase()
        .replace(/\s+/g, '-')
        .replace(/[^\w\-]+/g, '') // eslint-disable-line
        .replace(/\-\-+/g, '-') // eslint-disable-line
        .replace(/^-+/, '')
        .replace(/-+$/, '')
    },
    handleCardClick(e) {
      console.log(e)
      console.log(this.$route)
      this.$router.push({
        name: 'student-lms-schoolId-exercises-slug',
        params: { schoolId: this.$route.params.schoolId, slug: e.id },
        query: { _name: `${e.name}` },
      })
    },
  },
}
</script>
